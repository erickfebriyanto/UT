<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sistem Bahan Ajar</title>
    <!-- Bootstrap CSS dari CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Placeholder untuk navbar yang dimuat dinamis dari partial -->
    <div id="navbar"></div>

    <!-- Konten utama dashboard -->
    <div class="container my-3">
        <!-- Card untuk greeting section -->
        <div class="card">
            <div class="card-body">
                <!-- Greeting dinamis berdasarkan waktu -->
                <h1 class="h3 mb-2" id="greeting"></h1>
                <!-- Tanggal dan waktu lokal -->
                <div class="text-muted" id="datetime"></div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS untuk komponen interaktif (dropdown, toggle, dll) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Proteksi: wajib login (cek sessionStorage)
        const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
        if (!currentUser) window.location.href = 'index.html';

        // Memuat navbar (partial) dan set nama user setelah DOM navbar siap
        fetch('partials/navbar.html').then(r => r.text()).then(html => {
            document.getElementById('navbar').innerHTML = html;
            const el = document.getElementById('userName');
            if (el) el.textContent = currentUser.nama;
        });

        // UI
        function updateUI() {
            const now = new Date(), h = now.getHours();
            const greet = h < 5 ? 'Selamat Malam' : h < 11 ? 'Selamat Pagi' : h < 15 ? 'Selamat Siang' : h < 18 ? 'Selamat Sore' : 'Selamat Malam';
            document.getElementById('greeting').textContent = `${greet}, ${currentUser.nama}!`;
            document.getElementById('datetime').textContent = now.toLocaleString('id-ID', { dateStyle: 'full', timeStyle: 'short' });
        }

        // Logout (untuk tombol di navbar)
        function logout() {
            sessionStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }
        window.logout = logout;

        updateUI();
        setInterval(updateUI, 60000);
    </script>
</body>
</html>